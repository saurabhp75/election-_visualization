!function(t){"use strict";const e=(t,e)=>{const{colorValues:r,colorLabels:a,labelRectSize:s,labelSpacing:o,labelTextOffset:l,onColorClick:i,selectedColorValue:n,selectedConstituency:p}=e;t.selectAll(".tick").remove();const d=t.selectAll(".tick").data(r);d.exit().remove();const c=d.enter().append("g").attr("class","tick");c.merge(d).attr("transform",(t,e)=>`translate(0, ${e*o})`).attr("opacity",t=>!n||t===n||p?1:.2).on("click",t=>i(t===n?null:t)),c.append("rect").merge(d.select("rect")).attr("fill",(t,e)=>r[e]).attr("width",s).attr("height",s),c.append("text").merge(d.select("text")).text((t,e)=>a[e]).attr("dy","1.2em").attr("x",l)},r=()=>{const e=t.select("svg");return{width:+e.attr("width"),height:+e.attr("height")}},a=t.geoMercator().scale(1200).center([82.5,23]).translate([r().width/2,r().height/2]),s=t.geoPath().projection(a),o=(e,r)=>{console.log("choroplethMap called");const{features:a,colorScale:o,selectedColorValue:l,onConstituencyClick:i,selectedConstituency:n,div:p,partyMap:d,selectedFeature:c}=r,u=e.selectAll("path").data(a,t=>t.properties.ST_PC),h=u.enter().append("path").attr("class","constituency").attr("d",s);"Top 10 parties"===c?h.merge(u).attr("fill",t=>((t,e,r,a)=>{let s;return s=null===t.properties.Party||""===t.properties.Party?"black":r===t.properties.ST_PC?"yellow":a.hasOwnProperty(t.properties.Party)?e(t.properties.Party):e("Others")})(t,o,n,d)).attr("opacity",t=>((t,e,r,a,s)=>{let o;return r?r!=a("Others")?o=s.hasOwnProperty(t.properties.Party)&&r==a(t.properties.Party)?1:.2:(o=s.hasOwnProperty(t.properties.Party)?.2:1,""===t.properties.Party&&(o=.2)):o=1,o})(t,0,l,o,d)).classed("highlighted",t=>l&&l===o(t.properties.Party)).on("click",t=>i(t.properties.ST_PC===n?null:t.properties.ST_PC)).on("mouseover",t=>{p.transition().duration(300).style("opacity",.7),p.html("<p><strong>"+t.properties.PC_NAME_x+"</strong></p><table><tbody><tr><td class='wide'>MP:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){p.transition().duration(300).style("opacity",0)}):"Assets"===c?h.merge(u).attr("fill",t=>((t,e,r)=>{let a;return a=t.properties.Assets_num?r===t.properties.ST_PC?"yellow":e(t.properties.Assets_num):"black"})(t,o,n)).attr("opacity",t=>((t,e,r,a)=>{let s;return r?(s=r!=a(t.properties.Assets_num)?.2:1,null===t.properties.Assets_num&&(s=.2)):s=1,s})(t,0,l,o)).classed("highlighted",t=>l&&l===o(t.properties.Assets_num)).on("click",t=>i(t.properties.ST_PC===n?null:t.properties.ST_PC)).on("mouseover",e=>{p.transition().duration(300).style("opacity",.7),p.html("<p><strong>"+e.properties.PC_NAME_x+"</strong></p><table><tbody><tr><td class='wide'>MP:</td><td>"+e.properties.Candidate+"</td></tr><tr><td>Assets:</td><td>â‚¹"+t.format(",.2r")(e.properties.Assets_num)+"</td></tr><tr><td>Party:</td><td>"+e.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){p.transition().duration(300).style("opacity",0)}):"Criminal Case(s)"===c?h.merge(u).attr("fill",t=>((t,e,r)=>{let a;return a=null===t.properties.Criminal_C?"black":r===t.properties.ST_PC?"yellow":e(t.properties.Criminal_C)})(t,o,n)).attr("opacity",t=>((t,e,r,a)=>{let s;return r?(s=r!=a(t.properties.Criminal_C)?.2:1,null===t.properties.Criminal_C&&(s=.2)):s=1,s})(t,0,l,o)).classed("highlighted",t=>l&&l===o(t.properties.Criminal_C)).on("click",t=>i(t.properties.ST_PC===n?null:t.properties.ST_PC)).on("mouseover",t=>{p.transition().duration(300).style("opacity",.7),p.html("<p><strong>"+t.properties.PC_NAME_x+"</strong></p><table><tbody><tr><td class='wide'>MP:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Criminal case(s):</td><td>"+t.properties.Criminal_C+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){p.transition().duration(300).style("opacity",0)}):"Education"===c&&h.merge(u).attr("fill",t=>((t,e,r)=>{let a;return a=null===t.properties.Criminal_C?"black":r===t.properties.ST_PC?"yellow":e(t.properties.edu)})(t,o,n)).attr("opacity",t=>((t,e,r,a)=>{let s;return r?(s=r!=a(t.properties.edu)?.2:1,0===t.properties.edu&&(s=.2)):s=1,s})(t,0,l,o)).classed("highlighted",t=>l&&l===o(t.properties.edu)).on("click",t=>i(t.properties.ST_PC===n?null:t.properties.ST_PC)).on("mouseover",t=>{p.transition().duration(300).style("opacity",.7),p.html("<p><strong>"+t.properties.PC_NAME_x+"</strong></p><table><tbody><tr><td class='wide'>MP:</td><td>"+t.properties.Candidate+"</td></tr><tr><td>Education:</td><td>"+t.properties.Education+"</td></tr><tr><td>Party:</td><td>"+t.properties.Party+"</td></tr></td></tr></tbody></table>").style("left",event.pageX+"px").style("top",event.pageY-30+"px")}).on("mouseout",function(){p.transition().duration(300).style("opacity",0)})},l=(e,r)=>{const{selectedConstituency:a,selectedColorValue:s,features:o,colorValues:l,colorLabels:i,selectedFeature:n}=r,p=((e,r,a,s,o,l)=>{if(!e&&!r)return["Click on legend bar or Map"];if(e){const r=a.filter(t=>t.properties.ST_PC===e),s=r[0].properties.PC_NAME_x,o=null===r[0].properties.Candidate?"No data":r[0].properties.Candidate,l=null===r[0].properties.Party?"No data":r[0].properties.Party,i=null===r[0].properties.Education?"No data":r[0].properties.Education,n=null===r[0].properties.Criminal_C?"No data":r[0].properties.Criminal_C,p=r[0].properties.Assets_num?r[0].properties.Assets_num:"No data";return["Constituency: "+s,"MP: "+o,"Assets(Rs.): "+t.format(",.2r")(p),"Criminal case(s): "+n,"Education: "+i,"Party: "+l]}if(r){const t=s.indexOf(r);return"Assets"===l?[`MP(s) with assets:  ${o[t]}`]:"Criminal Case(s)"===l?[`MPs with ${o[t]} criminal case(s)`]:"Education"===l?[`MPs with education:  ${o[t]}`]:"Top 10 parties"===l?[`Constituencies won by: ${o[t]}`]:["This should not be displayed"]}})(a,s,o,l,i,n);e.selectAll("tspan").remove(),e.selectAll("tspan").data(p).enter().append("tspan").attr("x","0").attr("dy","1.5rem").text(t=>t)};let i,n,p,d,c,u,h,y="Assets";let C,g,m,f,P,b,_,x;const v=(t,e,r,a,s,o)=>{x=((t,e,r,a,s,o)=>{const l=e.reduce(function(t,e){return t.length>e.length?t:e});return{width:r+a+5*(o.length>l.length?o:l).length+a,height:s*(t.length+2)}})(t,e,r,a,s,o),(m=w.selectAll(".colorLegend").data([o])).exit().remove(),m=m.enter().append("g").merge(m).attr("class","colorLegend").attr("transform",`translate(10, ${k-x.height})`),(b=m.selectAll("rect").data([o])).exit().remove(),b.enter().append("rect").merge(b).attr("x",-r).attr("y",-r).attr("width",x.width).attr("height",x.height).attr("fill","red").attr("rx",r).attr("stroke","black").attr("stroke-width",1).attr("opacity",.3),(f=m.selectAll(".legendTitle").data([o])).exit().remove();const l=f.enter().append("g").merge(f).attr("class","legendTitle").selectAll("text").data([o]);l.enter().append("text").merge(l).text(o),(P=m.selectAll(".legendBody").data([o])).exit().remove(),_=P.enter().append("g").attr("transform",`translate(0, ${s/2})`).attr("class","legendBody").merge(P)};t.select("#menus").call((t,e)=>{const{options:r,onOptionClicked:a}=e;let s=t.selectAll("select").data([null]);const o=(s=s.enter().append("select").merge(s).on("change",function(){a(this.value)})).selectAll("option").data(r);o.enter().append("option").merge(o).attr("value",t=>t).text(t=>t)},{options:["Assets","Criminal Case(s)","Education","Top 10 parties"],onOptionClicked:t=>{p=null,i=null,y=t,V(),R()}});const A=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),w=t.select("svg"),k=w.attr("height"),T=w.attr("width"),E=w.append("g"),S=w.append("g").attr("transform",`translate(${T-370-15},20)`),M=S.selectAll("rect").data([null]);M.enter().append("rect").merge(M).attr("width",370).attr("height",170).attr("fill","red").attr("stroke","black").attr("stroke-width",1).attr("rx",10).attr("opacity",.3);const O=S.selectAll("text").data([null]),N=O.enter().append("text").attr("class","infoText").attr("transform","translate(10,5)").merge(O);w.append("rect").attr("x",0).attr("y",0).attr("height",r().height).attr("width",r().width).style("stroke","black").style("fill","none").style("stroke-width",1);w.call(t.zoom().on("zoom",()=>{E.attr("transform",t.event.transform),A.attr("transform",t.event.transform)}));const V=()=>{"Top 10 parties"===y?(c=["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],u=d=["BJP","INC","DMK","AITC","YSRCP","SHS","JD(U)","BJD","BSP","TRS","Others"],(h=t.scaleOrdinal()).domain(d).range(c),v(c,u,30,40,30,C="Top 10 parties")):"Assets"===y?(h=t.scaleThreshold(),d=[1e7,1e8,1e9,2e9,5e9],c=["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],u=["< 1 Crore","1 - 10 Cr.","10 - 100 Cr.","100 - 200 Cr.","200 - 500 Cr.","> 500 Cr."],h.domain(d).range(c),c.reverse(),u.reverse(),v(c,u,30,40,30,C="Assets(Rs.)")):"Criminal Case(s)"===y?(d=[1,2,6,11,21],c=["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],u=["None","1","2 - 5","6 - 10","11 - 20","> 20"],(h=t.scaleThreshold()).domain(d).range(c),c.reverse(),u.reverse(),v(c,u,30,40,30,C="Criminal Case(s)")):"Education"===y&&(d=[2,3,4,5,6,7],c=["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],u=["Illiterate","Others","School","Graduate","Post Graduate","Doctorate"],(h=t.scaleOrdinal()).domain(d).range(c),c.reverse(),u.reverse(),v(c,u,30,40,30,C="Education"))},$=t=>{p&&(p=null),i=t,R()},L=t=>{i&&(i=null),p=t,R()};(()=>t.json("https://raw.githubusercontent.com/saurabhp75/election_visualization/master/data/merged_pc_map_pok.json").then(t=>{return t.features}))().then(t=>{(t=>{t.forEach(t=>{"Doctorate"===t.properties.Education?t.properties.edu=7:"Post Graduate"===t.properties.Education?t.properties.edu=6:"Graduate Professional"===t.properties.Education||"Graduate"===t.properties.Education?t.properties.edu=5:"12th Pass"===t.properties.Education||"10th Pass"===t.properties.Education||"8th Pass"===t.properties.Education||"5th Pass"===t.properties.Education||"Literate"===t.properties.Education?t.properties.edu=4:"Others"===t.properties.Education?t.properties.edu=3:"Illiterate"===t.properties.Education?t.properties.edu=2:t.properties.edu=0})})(n=t),g=(t=>{let e=t.reduce((t,e)=>{let r=e.properties.Party;return t.hasOwnProperty(r)||(t[r]=0),t[r]++,t},{}),r=[];for(let t in e)r.push([t,e[t]]);r.sort(function(t,e){return e[1]-t[1]}),r=r.slice(0,10);const a={};for(var s=0;s<r.length;++s)a[r[s][0]]=r[s][1];return a})(n),V(),R()});const R=()=>{E.call(o,{features:n,colorScale:h,selectedColorValue:i,onConstituencyClick:L,selectedConstituency:p,div:A,partyMap:g,selectedFeature:y}),_.call(e,{colorValues:c,colorLabels:u,labelRectSize:30,labelSpacing:30,labelTextOffset:40,onColorClick:$,selectedColorValue:i,selectedConstituency:p,selectedFeature:y}),N.call(l,{selectedConstituency:p,selectedColorValue:i,features:n,colorValues:c,colorLabels:u,selectedFeature:y})}}(d3);
//# sourceMappingURL=bundle.js.map
